<div class="p-4">
  <p-toast></p-toast>
  <form [formGroup]="form" (ngSubmit)="onSubmit()">
    <!-- Details, Sessions and Notes Cards -->
    <p-card styleClass="custom-card shadow-none mb-4">
      <ng-template pTemplate="content">
        <!-- Details Section -->
        <formly-form [form]="form" [fields]="detailsFields" [model]="model"></formly-form>

        <!-- Sessions Component -->
        <app-session-form
          [initialData]="sessions"
          [academicPeriodId]="model.academicPeriod"
          [disabled]="isLoading"
          (sessionsChange)="onSessionsChange($event)"
          (validationChange)="onSessionValidationChange($event)">
        </app-session-form>

        <!-- Notes Section -->
        <formly-form [form]="form" [fields]="notesFields" [model]="model"></formly-form>
      </ng-template>
    </p-card>

    <!-- Submit and Cancel Buttons -->
    <div class="flex justify-content-end mt-3 gap-2">
      <app-outline-button
        [borderColor]="'red'"
        [textColor]="'red'"
        [hoverBackgroundColor]="'red'"
        [hoverTextColor]="'white'"
        [disabled]="isLoading"
        (click)="onCancel()">
          {{ 'common.cancel' | translate }}
      </app-outline-button>
      <app-outline-button
        [borderColor]="'var(--primary-color)'"
        [type]="'submit'"
        [disabled]="isLoading">
          <span *ngIf="isLoading" class="pi pi-spin pi-spinner mr-2"></span>
          {{ isLoading ? 'Saving...' : submitButtonLabel }}
      </app-outline-button>
    </div>
  </form>
</div> 