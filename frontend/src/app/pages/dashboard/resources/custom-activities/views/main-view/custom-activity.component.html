<div *ngIf="!active">
  <div class="main" *ngIf="currentRoleTitle !== 'STUDENT'">
    <div style="display: flex; width: fit-content; align-items: center; gap: 35px; user-select: none">
      <div style="display: flex; align-items: center; gap: 5px">
        <!-- <a routerLink="/resources/custom-activities/create"> -->
        <i class="pi pi-plus-circle" style="color: var(--primary-color)" (click)="onCreateClick($event, userId)"></i>
        <label class="label-title-small" style="margin-left: 5px; cursor: pointer" (click)="onCreateClick($event, userId)">
          <u>{{ 'customActivities.create_interactive_activity' | translate }}</u></label
        >
        <!-- </a> -->
      </div>
      <p-button
        [icon]="view === 'table' ? 'pi pi-th-large' : 'pi pi-list'"
        styleClass="p-button-text border-circle ml-2"
        (click)="toggleView($event)"
      />
    </div>
    <div>
      <label class="label-title-big">{{ 'customActivities.private_interactive_activities' | translate }}</label>
      <p-table [value]="privateCustomActivities" [responsive]="true" *ngIf="view === 'table'">
        <ng-template pTemplate="header">
          <tr>
            <th pSortableColumn="image">{{ 'customActivities.template' | translate }}</th>
            <th pSortableColumn="title">{{ 'customActivities.title' | translate }}</th>
            <th pSortableColumn="typeString">{{ 'customActivities.type' | translate }}</th>
            <th pSortableColumn="playerModeString">{{ 'customActivities.gameplay' | translate }}</th>
            <th pSortableColumn="createdBy">{{ 'customActivities.created_by' | translate }}</th>
            <th pSortableColumn="createdAt">{{ 'customActivities.created_on' | translate }}</th>
            <th pSortableColumn="public">{{ 'customActivities.public' | translate }}</th>
            <th></th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-customActivities>
          <tr>
            <td>
              <img
                [src]="'assets/images/custom-activities/templates/' + customActivities.template + '.png'"
                style="height: 50px; width: auto; max-width: 100%"
              />
            </td>
            <td>{{ customActivities.title }}</td>
            <td>{{ customActivities.typeString }}</td>
            <td>{{ customActivities.playerModeString }}</td>
            <td>
              {{ customActivities.userId?.firstname + ' ' + customActivities.userId?.lastname || 'user' }}
            </td>
            <td>{{ customActivities.createdAt | date : 'medium' }}</td>
            <td>
              <p-inputSwitch [disabled]="true" [(ngModel)]="customActivities.settings.public"></p-inputSwitch>
            </td>
            <td style="text-align: center; vertical-align: middle">
              <!--<p-button label="Copy to..." (click)="showOverlay($event, customActivities.id)" />-->
              <p-button (onClick)="duplicateActivity(customActivities.id)" icon="pi pi-copy" class="p-button-text p-mr-2"></p-button>
              <p-button (onClick)="editActivity(customActivities.id)" icon="pi pi-pencil"></p-button>
              <p-button (onClick)="launchActivity(customActivities.id)" icon="pi pi-play"></p-button>
              <p-button (onClick)="deleteActivity(customActivities.id)" icon="pi pi-trash" styleClass="pi-trash-new"></p-button>
            </td>
          </tr>
        </ng-template>
      </p-table>
      <div class="p-grid" style="display: flex; gap: 10px; padding: 10px; flex-wrap: wrap" *ngIf="view === 'tiles'">
        <div *ngFor="let customActivities of privateCustomActivities">
          <p-card [header]="customActivities.title">
            <div style="display: flex; flex-direction: column; gap: 10px">
              <img
                [src]="'assets/images/custom-activities/templates/' + customActivities.template + '.png'"
                style="height: 50px; width: auto; max-width: 50px"
                alt="Template Image"
              />
              <div>
                <strong>{{ 'customActivities.type' | translate }}:</strong> {{ customActivities.typeString }}
              </div>
              <div>
                <strong>{{ 'customActivities.gameplay' | translate }}:</strong> {{ customActivities.playerModeString }}
              </div>
              <div>
                <strong>{{ 'customActivities.created_by' | translate }}:</strong>
                {{ customActivities.userId?.firstname + ' ' + customActivities.userId?.lastname || 'user' }}
              </div>
              <div>
                <strong>{{ 'customActivities.created_on' | translate }}:</strong>
                {{ customActivities.createdAt | date : 'medium' }}
              </div>
              <div style="display: flex; align-items: center">
                <strong style="margin-right: 10px">{{ 'customActivities.public' | translate }}:</strong>
                <p-inputSwitch [disabled]="true" [(ngModel)]="customActivities.settings.public"></p-inputSwitch>
              </div>
              <div class="p-d-flex p-jc-end p-mt-2">
                <!--<p-button label="Copy to..." (click)="showOverlay($event, customActivities.id)" styleClass="copy-button" />-->
                <p-button (onClick)="duplicateActivity(customActivities.id)" icon="pi pi-copy" class="p-button-text p-mr-2"></p-button>
                <p-button (onClick)="editActivity(customActivities.id)" icon="pi pi-pencil" class="p-button-text p-mr-2"></p-button>
                <p-button (onClick)="launchActivity(customActivities.id)" icon="pi pi-play"></p-button>
                <p-button (onClick)="deleteActivity(customActivities.id)" icon="pi pi-trash" class="p-button-text"></p-button>
              </div>
            </div>
          </p-card>
        </div>
      </div>
    </div>
    <div>
      <label class="label-title-big">{{ 'customActivities.public_interactive_activities' | translate }}</label>
      <p-table [value]="publicCustomActivities" [responsive]="true" *ngIf="view === 'table'">
        <ng-template pTemplate="header">
          <tr>
            <th pSortableColumn="image">{{ 'customActivities.template' | translate }}</th>
            <th pSortableColumn="title">{{ 'customActivities.title' | translate }}</th>
            <th pSortableColumn="typeString">{{ 'customActivities.type' | translate }}</th>
            <th pSortableColumn="playerModeString">{{ 'customActivities.gameplay' | translate }}</th>
            <th pSortableColumn="createdBy">{{ 'customActivities.created_by' | translate }}</th>
            <th pSortableColumn="createdAt">{{ 'customActivities.created_on' | translate }}</th>
            <th pSortableColumn="public">{{ 'customActivities.public' | translate }}</th>
            <th></th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-customActivities>
          <tr *ngIf="userId !== customActivities.userId">
            <td>
              <img
                [src]="'assets/images/custom-activities/templates/' + customActivities.template + '.png'"
                style="height: 50px; width: auto; max-width: 100%"
              />
            </td>
            <td>{{ customActivities.title }}</td>
            <td>{{ customActivities.typeString }}</td>
            <td>{{ customActivities.playerModeString }}</td>
            <td>{{ customActivities.userId?.firstname + ' ' + customActivities.userId?.lastname || 'user' }}</td>
            <td>{{ customActivities.createdAt | date : 'medium' }}</td>
            <td>
              <p-inputSwitch [disabled]="true" [(ngModel)]="customActivities.settings.public"></p-inputSwitch>
            </td>
            <td style="text-align: center; vertical-align: middle">
              <p-button (onClick)="duplicatePublicActivity(customActivities.id)" icon="pi pi-copy"></p-button>
              <p-button (onClick)="launchActivity(customActivities.id)" icon="pi pi-play"></p-button>
            </td>
          </tr>
        </ng-template>
      </p-table>
      <div class="p-grid" style="display: flex; flex-wrap: wrap; gap: 10px; padding: 10px" *ngIf="view === 'tiles'">
        <div *ngFor="let customActivities of publicCustomActivities">
          <p-card [header]="customActivities.title">
            <div style="display: flex; flex-direction: column; gap: 10px">
              <img
                [src]="'assets/images/custom-activities/templates/' + customActivities.template + '.png'"
                style="height: 50px; width: auto; max-width: 50px"
                alt="Template Image"
              />
              <div>
                <strong>{{ 'customActivities.type' | translate }}:</strong> {{ customActivities.typeString }}
              </div>
              <div>
                <strong>{{ 'customActivities.gameplay' | translate }}:</strong> {{ customActivities.playerModeString }}
              </div>
              <div>
                <strong>{{ 'customActivities.created_by' | translate }}:</strong>
                {{ customActivities.userInfo?.username || 'user' }}
              </div>
              <div>
                <strong>{{ 'customActivities.created_on' | translate }}:</strong>
                {{ customActivities.createdAt | date : 'medium' }}
              </div>
              <div style="display: flex; align-items: center">
                <strong style="margin-right: 10px">{{ 'customActivities.public' | translate }}:</strong>
                <p-inputSwitch [disabled]="true" [(ngModel)]="customActivities.settings.public"></p-inputSwitch>
              </div>
              <div class="p-d-flex p-jc-end p-mt-2">
                <p-button (onClick)="duplicatePublicActivity(customActivities.id)" icon="pi pi-copy" class="p-button-text"></p-button>
                <p-button (onClick)="launchActivity(customActivities.id)" icon="pi pi-play" class="p-button-text"></p-button>
              </div>
            </div>
          </p-card>
        </div>
      </div>
    </div>
  </div>

  <div class="main" *ngIf="currentRoleTitle === 'STUDENT'">
    <div style="display: flex; width: fit-content; align-items: center; gap: 35px; user-select: none; cursor: pointer">
      <label class="label-title-big">{{ 'customActivities.interactive_activities' | translate }}</label>
      <p-button
        [icon]="view === 'table' ? 'pi pi-th-large' : 'pi pi-list'"
        styleClass="p-button-text border-circle ml-2"
        (click)="toggleView($event)"
      />
    </div>
    <div>
      <p-table [value]="studentActivities" [responsive]="true" *ngIf="view === 'table'">
        <ng-template pTemplate="header">
          <tr>
            <th pSortableColumn="title">{{ 'customActivities.title' | translate }}</th>
            <th pSortableColumn="typeString">{{ 'customActivities.type' | translate }}</th>
            <th pSortableColumn="class">{{ 'customActivities.class' | translate }}</th>
            <th pSortableColumn="createdBy">{{ 'customActivities.created_by' | translate }}</th>
            <th pSortableColumn="assignedOn">{{ 'customActivities.assigned_on' | translate }}</th>
            <th pSortableColumn="assignmentBundle">{{ 'customActivities.assignment_bundle' | translate }}</th>
            <th></th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-studentActivities>
          <tr>
            <td>{{ studentActivities.title }}</td>
            <td>{{ studentActivities.typeString }}</td>
            <td>{{ studentActivities.classId.name }}</td>
            <td>{{ studentActivities.userId.firstname + ' ' + studentActivities.userId.lastname || 'user' }}</td>
            <td>{{ studentActivities.updatedAt | date : 'medium' }}</td>
            <td>{{ studentActivities.assignmentBundle }}</td>
            <td style="text-align: center; vertical-align: middle">
              <p-button (onClick)="launchActivity(studentActivities.id)" icon="pi pi-play"></p-button>
            </td>
          </tr>
        </ng-template>
      </p-table>
      <div class="p-grid" style="display: flex; flex-wrap: wrap; gap: 10px; padding: 10px" *ngIf="view === 'tiles'">
        <div *ngFor="let customActivities of studentActivities">
          <p-card [header]="customActivities.title">
            <div style="display: flex; flex-direction: column; gap: 10px">
              <div>
                <strong>{{ 'customActivities.title' | translate }}:</strong> {{ customActivities.title }}
              </div>
              <div>
                <strong>{{ 'customActivities.type' | translate }}:</strong> {{ customActivities.typeString }}
              </div>

              <div>
                <strong>{{ 'customActivities.class' | translate }}:</strong> {{ customActivities.classId.name }}
              </div>
              <div>
                <strong>{{ 'customActivities.created_by' | translate }}:</strong>
                {{ customActivities.userId.firstname + ' ' + customActivities.userId.lastname || 'user' }}
              </div>
              <div>
                <strong>{{ 'customActivities.assigned_on' | translate }}:</strong>
                {{ customActivities.updatedAt | date : 'medium' }}
              </div>
              <div style="display: flex; align-items: center">
                <strong style="margin-right: 10px">{{ 'customActivities.assignment_bundle' | translate }}:</strong>
                {{ customActivities.assignmentBundle }}
              </div>
              <p-button (onClick)="launchActivity(customActivities.id)" icon="pi pi-play"></p-button>
            </div>
          </p-card>
        </div>
      </div>
    </div>
  </div>
  <app-loading [isLoading]="isLoading" />
  <app-warning-dialog [warningMessage]="warningMessage" [isDialogVisible]="isWarningDialogVisible" (onClose)="isWarningDialogVisible = false" />
  <app-info-dialog [infoMessage]="infoMessage" [isDialogVisible]="isInfoDialogVisible" (onClose)="isInfoDialogVisible = false" />
</div>
<!--<p-overlayPanel #op [dismissable]="true" my="right top" at="left top">
  <div *ngFor="let btn of buttons" style="margin: 5px">
    <p-button [label]="btn.label" (onClick)="buttonClicked(btn.id, op, selectedActivityId)"> </p-button>
  </div>
</p-overlayPanel>-->
<!--<app-solved-view [assignedmentId]="'68f23c5b43b35bc342b51189'" [studentId]="'68d659b35ef3057d286ffa01'" [customActivityId]="'691d9f175f41c4e6393182eb'"/>-->
<div *ngIf="active">
  <app-launch-student-view *ngIf="currentRoleTitle === 'STUDENT'" [active]="active" [activityId]="activityId" [assignmentId]="'68f23c5b43b35bc342b51189'" />
  <p-button label="Back" (click)="active = false" />
</div>
