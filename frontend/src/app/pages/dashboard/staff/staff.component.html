<p-confirmDialog #cd [dismissableMask]="true" [style]="{width: '450px'}">
  <ng-template pTemplate="headless" let-message>
    <div class="flex flex-column align-items-center p-5 surface-overlay border-round-xl">
      <div class="border-circle bg-red-100 inline-flex justify-content-center align-items-center h-6rem w-6rem -mt-4">
        <i class="pi pi-exclamation-triangle text-5xl text-red-500"></i>
      </div>
      <span class="font-bold text-2xl block mb-2 mt-4 text-900">
        {{ message.header }}
      </span>
      <p class="mb-0 text-600 text-center line-height-3">{{ message.message }}</p>
      <div class="flex align-items-center gap-3 mt-5">
        <p-button 
          [label]="'common.cancel' | translate" 
          icon="pi pi-times"
          severity="secondary" 
          size="large"
          [style]="{'min-width': '120px'}"
          (click)="cd.reject()" />
        <p-button 
          [label]="'common.delete' | translate" 
          icon="pi pi-trash"
          severity="danger" 
          size="large"
          [style]="{'min-width': '120px'}"
          (click)="cd.accept()" />
      </div>
    </div>
  </ng-template>
</p-confirmDialog>

<ng-container *ngIf="staff$ | async as staff">
  <div class="flex flex-column gap-4 px-4">
    <div class="flex justify-content-end mb-3 mt-3">
      <p-button icon="pi pi-plus" styleClass="p-button-text border-circle" (onClick)="navigateToCreate()"> </p-button>
      <p-button icon="pi pi-download" styleClass="p-button-text border-circle ml-2" (onClick)="downloadExcel()"> </p-button>
      <p-button
        [icon]="(viewMode$ | async) === 'list' ? 'pi pi-th-large' : 'pi pi-list'"
        styleClass="p-button-text border-circle ml-2"
        (onClick)="toggleViewMode()"
      >
      </p-button>
    </div>
    <div class="card position-relative">
      <!-- Add spinner with overlay when loading -->
      <app-spinner *ngIf="isLoading" [overlay]="true"></app-spinner>

      <app-primary-table
        [data]="staff"
        [columns]="tableColumns"
        [rows]="10"
        [totalRecords]="totalRecords"
        [viewMode]="(viewMode$ | async) || 'list'"
        (pageChange)="onPageChange($event)"
        (rowsPerPageChange)="onRowsPerPageChange($event)"
        (rowSelect)="onStaffSelect($event)"
        (editRow)="onEditStaff($event)"
        (viewRow)="onStaffSelect($event)"
        (deleteRow)="onDeleteStaff($event)"
        [dataKey]="'id'"
      >
      </app-primary-table>
    </div>
  </div>
</ng-container>
